---
import type { Trek } from '@/lib/types';
import TrekGrid from '@/components/trek/TrekGrid.astro';
import { api } from '@/lib/api';

interface Props {
  treks: Trek[];
  title?: string;
  subtitle?: string;
}

const { treks } = Astro.props;

let title = "Budget Friendly Treks";
let subtitle = "Amazing treks under ₹10,000";
if (Astro.props.title) title = Astro.props.title;
if (Astro.props.subtitle) subtitle = Astro.props.subtitle;

try {
  const section = await api.get<{ title?: string | null; subtitle?: string | null }>('/content/home/budget_treks');
  if (section?.title) title = section.title;
  if (section?.subtitle) subtitle = section.subtitle;
} catch (error) {
  // Use props or defaults
}
---

<section class="section bg-white">
  <div class="container-custom">
    <!-- Section Header -->
    <div class="text-center mb-12">
      <span class="inline-block text-primary-500 font-semibold text-sm uppercase tracking-wider mb-4">
        Under ₹10,000
      </span>
      <h2 class="text-3xl md:text-4xl font-bold text-secondary-600 mb-4">{title}</h2>
      <p class="text-lg text-neutral-600 max-w-2xl mx-auto">{subtitle}</p>
    </div>

    <!-- Trek Grid -->
    <TrekGrid treks={treks} columns={4} />

    {treks.length > 0 && (
      <div class="text-center mt-12">
        <a href="/treks?max_price=10000" class="btn-secondary">
          View All Budget Treks
          <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
    )}
  </div>
</section>
